<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Minimal Music Player with Expandable Track List</title>
    <!-- Include Google Fonts Roboto -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fff;
        }

        /* Header container */
        .header {
            padding: 10px 20px;
            background-color: #fff;
            cursor: pointer;
            border-bottom: 1px solid #e0e0e0;
        }

        .header.active {
            border-bottom: none;
        }

        /* Song info */
        .song-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .song-title {
            font-weight: bold;
            font-size: 1.2em;
            margin: 0;
            color: #000;
        }

        .post-date {
            font-size: 0.9em;
            margin: 0;
            color: #000;
        }

        /* Controls */
        .controls {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }

        .controls button {
            background: none;
            border: none;
            font-size: 1em;
            cursor: pointer;
            padding: 5px 10px;
            color: #000;
            margin-right: 5px;
        }

        /* Progress bar container */
        .progress-container {
            height: 10px;
            background-color: #e0e0e0;
            cursor: pointer;
            position: relative;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
        }

        /* Progress bar */
        .progress-bar {
            background-color: #000;
            width: 0%;
            height: 100%;
        }

        /* Expandable track list container */
        .track-list-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background-color: #fff;
            border-bottom: 1px solid #e0e0e0;
        }

        .track-list-container.active {
            max-height: 300px; /* Adjust as needed */
        }

        .track-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
            overflow-y: auto;
            max-height: 300px;
        }

        .track-list li {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 1px solid #e0e0e0;
            color: #000;
        }

        .track-list li:hover {
            background-color: #f9f9f9;
        }

        /* Image container */
        .image-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .image-container img {
            max-width: 100%;
            height: auto;
            object-fit: contain;
        }

        /* Hide the audio player controls */
        #audio-player {
            display: none;
        }
    </style>
</head>
<body>
    <!-- Header with song info and controls -->
    <div class="header" onclick="toggleTrackList()">
        <!-- Song info -->
        <div class="song-info">
            <div>
                <p class="song-title" id="song-title"></p>
                <p class="post-date" id="post-date"></p>
            </div>
            <!-- Controls -->
            <div class="controls">
                <button onclick="prevTrack(event)">⏮️</button>
                <button onclick="togglePlayPause(event)" id="play-pause-button">⏸️</button>
                <button onclick="playRandomTrack(event)">RANDOM</button>
                <button onclick="nextTrack(event)">⏭️</button>
            </div>
        </div>
        <!-- Progress bar -->
        <div class="progress-container" id="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
    </div>

    <!-- Expandable track list -->
    <div class="track-list-container" id="track-list-container">
        <ul class="track-list" id="track-list">
            <!-- Track items will be populated dynamically -->
        </ul>
    </div>

    <!-- Image -->
    <div class="image-container">
        <img id="cover-image" src="https://via.placeholder.com/600x400" alt="Cover Image">
    </div>

    <!-- Hidden audio player -->
    <audio id="audio-player"></audio>

    <script>
        // Array of image files to select from randomly
        const imageFiles = [
            'https://leightondigital.b-cdn.net/mp3/ypr.png',
            'https://leightondigital.b-cdn.net/mp3/unnamed.png',
            'https://leightondigital.b-cdn.net/mp3/turt.png',
            // Add the rest of your image URLs here
        ];

        // Array of tracks with URLs, song names, and dates
        const tracks = [
            {url: "https://leightondigital.b-cdn.net/13%20Sailors.mp3", name: "Plus Instruments - 13 Sailors", date: "17 July 2015"},
            {url: "https://leightondigital.b-cdn.net/A%20Lessons%20Learned%20In%20The%20Tears%20Of%20Deceit.mp3", name: "DeViere - Lessons Learned In The Tears Of Deceit", date: "21 April 2018"},
            {url: "https://leightondigital.b-cdn.net/a%20new%20obscurity.mp3", name: "Juanpablo &amp; Sneaker - A New Obscurity", date: "17 July 2015"},
            {url: "https://leightondigital.b-cdn.net/Achievement%20Rallies%20Success.mp3", name: "Compassion Crew - Achievement Rallies Success", date: "17 July 2015"},
            {url: "https://leightondigital.b-cdn.net/Air.mp3", name: "Point G - Air", date: "27 June 2015"},
            // Add the rest of your track objects here
        ];

        let currentIndex = 0;

        const player = document.getElementById("audio-player");
        const trackListContainer = document.getElementById("track-list-container");
        const header = document.querySelector(".header");

        // Function to decode HTML entities in track names
        function decodeHtmlEntities(text) {
            var txt = document.createElement("textarea");
            txt.innerHTML = text;
            return txt.value;
        }

        // Function to load a track and update player, info, and image
        function loadTrack(index) {
            const track = tracks[index];
            if (!track) return;
            player.src = track.url;
            document.getElementById("song-title").innerText = decodeHtmlEntities(track.name);
            document.getElementById("post-date").innerText = `Posted on: ${track.date}`;
            document.getElementById("cover-image").src = getRandomItem(imageFiles);
            updateProgressBar(); // Reset progress bar
            // Play the track after ensuring the metadata is loaded
            player.load();
            player.play().catch(error => {
                console.error('Playback failed:', error);
            });
        }

        // Function to get a random item from an array
        function getRandomItem(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        // Update progress bar as audio plays
        function updateProgressBar() {
            const progressBar = document.getElementById("progress-bar");
            const duration = player.duration;
            const currentTime = player.currentTime;
            const percent = (currentTime / duration) * 100;
            progressBar.style.width = percent + '%';
        }

        // Seek audio when progress bar is clicked
        document.getElementById("progress-container").addEventListener('click', function(event) {
            event.stopPropagation(); // Prevent triggering header click
            const progressContainer = this;
            const rect = progressContainer.getBoundingClientRect();
            const offsetX = event.clientX - rect.left;
            const totalWidth = rect.width;
            const percent = offsetX / totalWidth;
            player.currentTime = percent * player.duration;
        });

        // Update progress bar continuously
        player.addEventListener('timeupdate', updateProgressBar);

        // Update play/pause button based on audio state
        player.addEventListener('play', function() {
            document.getElementById("play-pause-button").innerHTML = "⏸️";
        });
        player.addEventListener('pause', function() {
            document.getElementById("play-pause-button").innerHTML = "▶️";
        });

        // Toggle play/pause
        function togglePlayPause(event) {
            event.stopPropagation(); // Prevent triggering header click
            if (player.paused) {
                player.play().catch(error => {
                    console.error('Playback failed:', error);
                });
            } else {
                player.pause();
            }
        }

        // Play a random track from the entire list
        function playRandomTrack(event) {
            event.stopPropagation(); // Prevent triggering header click
            const randomIndex = Math.floor(Math.random() * tracks.length);
            currentIndex = randomIndex;
            loadTrack(currentIndex);
        }

        // Load the previous track
        function prevTrack(event) {
            event.stopPropagation(); // Prevent triggering header click
            if (currentIndex > 0) {
                currentIndex--;
            } else {
                currentIndex = tracks.length - 1; // Loop back to the last track
            }
            loadTrack(currentIndex);
        }

        // Load the next track
        function nextTrack(event) {
            event.stopPropagation(); // Prevent triggering header click
            if (currentIndex < tracks.length - 1) {
                currentIndex++;
            } else {
                currentIndex = 0; // Loop back to the first track
            }
            loadTrack(currentIndex);
        }

        // Autoplay the next track when the current one ends
        player.addEventListener("ended", nextTrack);

        // Keyboard controls for navigation
        document.addEventListener("keydown", function(event) {
            if (event.key === "ArrowRight") { // Right arrow for next
                nextTrack(event);
            } else if (event.key === "ArrowLeft") { // Left arrow for previous
                prevTrack(event);
            } else if (event.key === " ") { // Spacebar for play/pause
                event.preventDefault(); // Prevent page scrolling
                togglePlayPause(event);
            }
        });

        // Function to toggle the track list
        function toggleTrackList() {
            trackListContainer.classList.toggle('active');
            header.classList.toggle('active');
        }

        // Function to populate the track list
        function populateTrackList() {
            const trackListElement = document.getElementById('track-list');
            trackListElement.innerHTML = ''; // Clear existing list

            tracks.forEach((track, index) => {
                const listItem = document.createElement('li');
                listItem.textContent = decodeHtmlEntities(track.name);
                listItem.dataset.index = index;
                listItem.addEventListener('click', function(event) {
                    event.stopPropagation(); // Prevent triggering header click
                    currentIndex = parseInt(this.dataset.index);
                    loadTrack(currentIndex);
                    toggleTrackList(); // Collapse the track list after selection
                });
                trackListElement.appendChild(listItem);
            });
        }

        // Initialize the player on page load
        window.onload = function() {
            populateTrackList();
            currentIndex = 0;
            loadTrack(currentIndex);
        };
    </script>
</body>
</html>
